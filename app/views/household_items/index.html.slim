= provide(:title, @moving.name)

h1 
  = @moving.name

p 
  = @moving.description

.controls
  = link_to fa_icon("pencil"), edit_moving_path(@moving)
  = link_to fa_icon("times"), @moving, method: :delete, data: { confirm: 'Are you sure?' }

hr

.form-group
  = link_to "Add item", new_moving_household_item_path(@moving, @household_item), class: "btn btn-primary"   

.row
  .col-sm-6
    .well
      #moving_volume_pie_chart[style="width:100%; height:auto;"]
  .col-sm-6
    = render "shared/moving_stats", moving: @moving, household_items: @household_items
    
= render "shared/moving_filter_forms", moving: @moving, household_items: @household_items
= render "shared/moving_items", moving: @moving, household_items: @household_items

javascript:

  // Configure the pie chart.
  // http://www.highcharts.com/demo
  // 
  // Data structure:
  // - categories: ['Africa', 'America', 'Asia', 'Europe', 'Oceania']
  // - data: [107, 31, 635, 203, 2]
  $(function () {
    // Embed the json data at server side.
    var data = #{raw @data}
    var unit = ' cft'

    // Build the chart.
    $('#moving_volume_pie_chart').highcharts(
      {
        chart: {
            type: 'bar'
        },
        title: {
            text: 'Volume of each tag'
        },
        xAxis: {
            categories: data["names"],
            title: {
                text: null
            }
        },
        yAxis: {
            min: 0,
            title: {
                text: unit,
                align: 'high'
            },
            labels: {
                overflow: 'justify'
            }
        },
        tooltip: false,
        plotOptions: {
            bar: {
                dataLabels: {
                    enabled: true
                }
            }
        },
        legend: {
            x: 9999, // Make the legend invisible.
            y: 9999
        },
        credits: {
            enabled: false
        },
        series: [{
            name: 'volume',
            data: data["values"]
        }]
    });
  });
